{"version":3,"sources":["./src/app/catalogue/catalogue.page.html","./src/app/catalogue/catalogue.module.ts","./src/app/catalogue/catalogue.page.scss","./src/app/catalogue/catalogue.page.ts"],"names":[],"mappings":"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","file":"catalogue-catalogue-module-es2015.js","sourcesContent":["export default \"<app-header [title]=\\\"'Catalogue'\\\"></app-header>\\n<ion-content class=\\\"home\\\" padding >\\n    <span *ngIf=\\\"this.AvailableCount\\\" style=\\\"color: green; font-size: .8em;align-content: right\\\">\\n      Total Books:{{this.AvailableCount}}({{this.books.length}}); Rented Out:{{this.RentedOut}}</span>\\n    <ion-item>\\n      <ion-searchbar\\n        [showCancelButton]=\\\"true\\\"\\n        (ionInput)=\\\"FilterBookDB($event)\\\"\\n        (ionCancel)=\\\"searchBookDB($event)\\\">\\n      </ion-searchbar>\\n    </ion-item>\\n    <ion-list>\\n      <ion-item-sliding *ngFor=\\\"let book of books | search : DescriptionSearch : null\\\" >\\n        <ion-item>\\n\\n             <ion-avatar thumbnail  slot=\\\"start\\\" (click)=\\\"bookInfo(book)\\\">\\n                  <img src=\\\"{{book.PictureLink}}\\\" />\\n              </ion-avatar>\\n              <ion-label text-wrap> \\n                  <h2>{{book.Description}}</h2>\\n                  <p *ngIf=\\\"book.TotalCopies > 0\\\" class=\\\"item-description\\\">\\n                    Available : {{book.TotalCopies - book.RentedCopies}}\\n                  <span *ngIf=\\\"book.RentedCopies > 0\\\">[Checked Out : {{book.RentedCopies}}]</span></p>\\n                  <p *ngIf=\\\"book.TotalCopies == 1\\\" style=\\\"color:green;\\\">{{book.Code}} </p>\\n              </ion-label>\\n\\n          <ion-icon *ngIf=\\\"book.WishList != 'Y'\\\" name=\\\"heart-empty\\\" (click)=\\\"AddToWishList(book,'Y','Added to Wish List!')\\\" style=\\\"color:red\\\" title=\\\"Add to Wish list\\\"></ion-icon>\\n          <ion-icon *ngIf=\\\"book.WishList === 'Y'\\\" name=\\\"heart\\\" (click)=\\\"AddToWishList(book,'N','Removed from your Wish List!')\\\" style=\\\"color:red\\\" title=\\\"Remove from Wish list\\\"></ion-icon>\\n      </ion-item>\\n        <ion-item-options *ngIf=\\\"this.authentication.getIsAdmin() == 'Y'\\\" side=\\\"end\\\">\\n          <button ion-button color=\\\"danger\\\" style=\\\"background-color: red;color:white\\\" (click)=\\\"returnBook(book)\\\"  *ngIf=\\\"book.RentedCopies > 0 \\\">\\n              <ion-icon name=\\\"refresh\\\"></ion-icon>\\n              Return ({{book.RentedCopies}})\\n          </button>\\n          <button ion-button  color=\\\"primary\\\" style=\\\"background-color: green; color:white\\\" (click)=\\\"checkout(book)\\\" *ngIf=\\\"(book.TotalCopies - book.RentedCopies) > 0\\\" >\\n              <ion-icon name=\\\"cart\\\"></ion-icon>\\n            Check out ({{book.TotalCopies - book.RentedCopies}})\\n          </button>\\n        </ion-item-options>\\n      </ion-item-sliding>\\n    </ion-list>\\n</ion-content>\\n\\n\\n\\n\"","import { LayoutModule } from '../layout/layout.module';\nimport { CataloguePage } from './catalogue.page';\nimport { IonicModule } from '@ionic/angular';\nimport { RouterModule } from '@angular/router';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { PipesModule } from 'src/shared/pipes.module';\n@NgModule({\n  imports: [\n    IonicModule,\n    CommonModule,\n    FormsModule,\n    RouterModule.forChild([{ path: '', component: CataloguePage }]), PipesModule, LayoutModule\n  ],\n  declarations: [CataloguePage]\n})\nexport class CataloguePageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2NhdGFsb2d1ZS9jYXRhbG9ndWUucGFnZS5zY3NzIn0= */\"","import { HeaderPage } from 'src/app/layout/header';\nimport { NavigationOptions } from '@ionic/angular/dist/providers/nav-controller';\nimport { Component } from '@angular/core';\nimport { NavController, ToastController, Platform, LoadingController, ActionSheetController } from '@ionic/angular';\nimport { ICBService } from 'src/shared/service';\nimport { Authentication } from 'src/shared/shared';\nimport { MasterDetailService } from 'src/providers/data-service/masterDetailService';\n\n\n\n@Component({\n  selector: 'app-catalogue',\n  templateUrl: 'catalogue.page.html',\n  styleUrls: ['catalogue.page.scss'],\n  providers: [ICBService, HeaderPage]\n})\nexport class CataloguePage {\n  books: Array<any>; Available: Array<any>;\n  AvailableCount: any; RentedOut: any ; queryval = '';\n  loader: any ; DescriptionSearch = '';\n\n  constructor(public navCtrl: NavController, private service: ICBService, public platform: Platform,\n              public actionsheetCtrl: ActionSheetController, public authentication: Authentication,\n              public loading: LoadingController, public toastCtrl: ToastController, private ms: MasterDetailService) {\n\n      }\n\n\n   async ionViewWillEnter() {\n   // if (this.books != null) {return; }\n    if ( this.authentication.getAccessToken() != null) {\n        this.loader = await this.loading.create({message: 'Getting books...'});\n        this.searchBookDB(null);\n      } else {\n        this.navCtrl.navigateForward('tabs/login');\n      }\n  }\n\n  searchBookDB(event: any ) {\n     if ( event ) {\n      if (event.target.value !== undefined) {\n        this.queryval = event.target.value;\n      }\n     }\n     if ( this.queryval.length > 1 ||  this.queryval === '' ) {\n\n\n        this.loader.present().then(() => {\n          this.service.searchTrans('book', this.queryval).then(\n            data => {\n              console.log(data);\n              this.books = data;\n              this.RentedOut =  this.books.reduce((previous, current) => {\n                return previous + parseInt(current.RentedCopies, 10);\n              }, 0);\n              this.AvailableCount = this.books.reduce((previous, current) => {\n                return previous + parseInt(current.TotalCopies, 10);\n              }, 0);\n              this.loader.dismiss();\n                  }\n              ).catch(err => {\n                console.log(err);\n            });\n\n        });\n\n\n\n      }\n  }\n  getIdCheval() {\n\n    this.AvailableCount = this.books.reduce((previous, current) => {\n      return previous + parseInt(current.Course.allocation, 10);\n    }, 0);\n  }\n  FilterBookDB(event: any ) {\n    this.DescriptionSearch = event.target.value;\n\n}\n\n  bookInfo( key: any ) {\n    this.ms.setDestn(key);\n    this.navCtrl.navigateForward('tabs/bookInfo');\n  }\n  AddToWishList(key: any , flag: any , message: any ) {\n    this.service.AddToWishList(key.ISBN).then(\n      async data => {\n        const toast = await this.toastCtrl.create({\n         message,\n         duration: 1000\n       });\n        toast.present();\n        key.WishList = flag;\n      }\n);\n  }\n  returnBook( key: any ) {\n\n        if (key.TotalCopies > 1 ) {\n          this.ms.setDestn(key);\n          this.navCtrl.navigateForward('tabs/multipleReturnPage');\n        } else {\n          this.service.markReturn(key.RentedTransId).then(\n            async data => {\n              const toast = await this.toastCtrl.create({\n               message: 'Returned successfully !',\n               duration: 2000\n             });\n              toast.present();\n              this.searchBookDB(null);\n      });\n    }\n  }\n  checkout( key: any) {\n    this.ms.setDestn(key);\n    this.ms.setAction('Out');\n    if (key.TotalCopies > 1 ) {\n      this.navCtrl.navigateForward('tabs/multiCopiesPage');\n    } else {\n      this.ms.setHome('C');\n      this.navCtrl.navigateForward('tabs/checkoutPage');\n  }\n\n  }\n  openMenu(event, key) {\n    this.service.getBookProfile(key.ISBN).then(\n      async data => {\n        this.Available = data;\n        this.RentedOut = this.Available.filter((t) => t.Status === '3').length;\n        this.AvailableCount = this.Available.filter((t) => t.Status !== '3').length;\n        const actionSheet = await this.actionsheetCtrl.create({\n          header: 'Click the link below.',\n          cssClass: 'action-sheets-basic-page',\n          buttons: [\n              {\n                  text: 'Book Info [Count: ' + this.Available.length + ']',\n                  role: 'destructive',\n                  icon: !this.platform.is('ios') ? 'list' : null,\n                  handler: () => {\n                     const navigationOptions: NavigationOptions = {\n                      queryParams: {\n                        book: key\n                      }\n                    };\n                     this.navCtrl.navigateForward('CheckOutPage', navigationOptions);\n                  }\n              },\n       /*       {\n                  text: 'Checked Out - ' + this.RentedOut,\n                  icon: !this.platform.is('ios') ? 'share' : null,\n                  handler: () => {\n                      //console.log('Checked Out clicked');\n                      if( this.RentedOut > 0 )\n                      this.navCtrl.push(TransPage, {\n                        book:key, isbn: key.ISBN,action: 'Out'\n                    });\n                  }\n              },\n              {\n                  text: 'Available - ' + this.AvailableCount,\n                  icon: !this.platform.is('ios') ? 'arrow-dropright-circle' : null,\n                  handler: () => {\n                    if( this.AvailableCount > 0 )\n                    this.navCtrl.push(RentPage, {\n                      book:key, isbn: key.ISBN,action: 'Out'\n                  });\n                  }\n              },*/\n\n              {\n                  text: 'Cancel',\n                  role: 'cancel', // will always sort to be on the bottom\n                  icon: !this.platform.is('ios') ? 'close' : null,\n                  handler: () => {\n                  }\n              }\n          ]\n      });\n        actionSheet.present();\n    });\n  }\n  itemTapped(event, book) {\n    const navigationOptions: NavigationOptions = {queryParams: {book}};\n    this.navCtrl.navigateForward('BookInfo', navigationOptions);\n\n     /*this.navCtrl.push(BookInfo, {\n          book\n      });*/\n  }\n\n}\n"],"sourceRoot":"webpack:///"}